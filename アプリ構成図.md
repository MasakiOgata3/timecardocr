# タイムカードOCRアプリケーション 構成図・フロー図

## 1. システム全体構成図

```
┌─────────────────────────────────────────────────────────────┐
│                      タイムカードOCRアプリ                    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────┐    ┌─────────────────┐                │
│  │   フロントエンド   │    │   バックエンド    │                │
│  ├─────────────────┤    ├─────────────────┤                │
│  │ HTML5           │    │ Node.js         │                │
│  │ CSS3            │◄───┤ Express.js      │                │
│  │ JavaScript      │    │ multer          │                │
│  │ Bootstrap 5     │    │ Sharp           │                │
│  │ Axios           │    │ ExcelJS         │                │
│  └─────────────────┘    └─────────────────┘                │
│                                   │                         │
│                          ┌────────▼────────┐                │
│                          │  外部APIサービス  │                │
│                          ├─────────────────┤                │
│                          │ Google Vision   │                │
│                          │ API (OCR)       │                │
│                          └─────────────────┘                │
│                                                             │
│  ┌─────────────────┐                                        │
│  │   データ保存     │                                        │
│  ├─────────────────┤                                        │
│  │ JSONファイル     │                                        │
│  │ ・設定情報      │                                        │
│  │ ・処理履歴      │                                        │
│  │ ・一時データ    │                                        │
│  └─────────────────┘                                        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 2. 概念図（コンポーネント関係）

```
┌─────────────────────────────────────────────────────────────┐
│                      ユーザー                                │
└─────────────────────┬───────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                 WEBブラウザ                                   │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │ ファイル     │  │ OCR結果     │  │ ダウンロード │         │
│  │ アップロード │  │ 確認・編集   │  │ (CSV/Excel) │         │
│  │ 画面        │  │ 画面        │  │ 画面        │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
└─────────────────────┬───────────────────────────────────────┘
                      │ HTTP Request/Response
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                 Node.js Server                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │ ファイル     │  │ OCR処理     │  │ ファイル     │         │
│  │ アップロード │  │ コントローラ │  │ 出力        │         │
│  │ API         │  │             │  │ API         │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
└─────────────────────┬───────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                 Google Vision API                           │
│               (文字認識サービス)                              │
└─────────────────────────────────────────────────────────────┘
```

## 3. データフロー図

```
[ユーザー] ──┐
            │ 1. タイムカード画像アップロード
            ▼
[フロントエンド]
            │ 2. FormData作成 + ファイル送信
            ▼
[Node.js API] ──┐
                │ 3. 画像ファイル受信・保存
                │
                ▼ 4. Google Vision API呼び出し
[Google Vision API]
                │ 5. OCR結果返却
                ▼
[Node.js API] ──┐
                │ 6. OCR結果処理・構造化
                │
                ▼ 7. JSON形式でレスポンス
[フロントエンド]
                │ 8. OCR結果表示・編集画面
                │
                ▼ 9. 編集完了データ送信
[Node.js API] ──┐
                │ 10. CSV/Excel生成
                │
                ▼ 11. ファイルダウンロード
[ユーザー]
```

## 4. ユーザーフロー図

```
[開始] 
  │
  ▼
[メイン画面表示]
  │
  ▼
[ファイル選択/ドロップ] ───► [ファイル形式チェック] ─No─► [エラー表示]
  │                                    │                     │
  │                                   Yes                    │
  ▼                                    │                     │
[アップロード実行] ──────────────────────┘                     │
  │                                                          │
  ▼                                                          │
[処理中表示]                                                  │
  │                                                          │
  ▼                                                          │
[OCR結果表示] ─────► [結果に満足？] ─No─► [手動編集] ────────┘
  │                      │                  │
  │                     Yes                 │
  ▼                      │                  │
[出力形式選択] ◄──────────┘                  │
  │                                         │
  ▼                                         │
[ダウンロード実行] ◄─────────────────────────┘
  │
  ▼
[完了]
```